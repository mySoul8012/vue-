<template>
    <div>
        <BoxHeader :msg="msg"></BoxHeader>
        <div>
            <el-container>
                <Menum @callFather="changeData"></Menum>
                <BoxIndex v-show="cur==0"></BoxIndex>
                <ProductSelect v-show="cur==1"></ProductSelect>
                <TitleManagement v-show="cur==2"  @func="getMsgFormSon" id="printTable" :tableData="tableData" :tabheight="tabheight"
                                 :tableHeader="tableHeader"
                                 :loading="loading" :isshow="isshow"
                                 :pagUn="pagUn"
                                 :pageSizeNumber="pageSizeNumber"
                                 :pagOn="pagOn" @changePagOn="changePagOn"
                                 @changePagUn="changePagUn"
                                 :pageNum="pageNum" @changePageNum="changePageNum" @changeDataPage="changeDataPage"
                ></TitleManagement>
            </el-container>
        </div>
    </div>
</template>
<style>
    .el-header {
        background-color: #B3C0D1;
        color: #333;
    }

    .el-aside {
        color: #333;
    }
</style>
<script>
    import Menum from "../components/Menum";
    import BoxIndex from "../components/BoxIndex";
    import BoxHeader from "../components/BoxHeader";
    import ProductSelect from "../components/ProductSelect";
    import TitleManagement from "../components/TitleManagement";
    import axios from 'axios'
    export default {
        components: {
            TitleManagement,
            Menum,
            BoxIndex,
            BoxHeader,
            ProductSelect
        },
        data() {
            return {
                pageNum: 1,
                pageSizeNumber: 0,
                pagOn: 0,
                pagUn: 0,
                msg: 'https://www.iming.info/',
                cur: 0,
                loading: false,
                isshow: true,
                tabheight: '100%', // 表格高度，这里是做了自适应高度，正常是需要写固定值的
                tableHeader: [      // 表头
                    {prop: 'UserId', label: '用户ID'},
                    {prop: 'UserName', label: '用户昵称'},
                    {prop: 'Time', label: '封号时间'},
                    {prop: 'Notes', label: '原因备注'},
                    // 此处为操作栏，不需要可以删除，clickFun绑定此操作按钮的事件
                    {
                        prop: 'oper', label: '操作', fixed: 'right', minWidth: '160px', width: '160px',
                        oper: [
                            {name: '解封', style: 'primary', clickFun: this.handleClick}
                        ]
                    }
                ],
                tableData: [
                ],
        }
        },
        methods: {
            changeData(cur){
                console.log(444444);
                console.log(cur);
                this.cur = cur;
            },
            changePagOn(pagOn){
                this.pagOn = pagOn;
            },
            changePagUn(pagUn){
                this.pagUn = pagUn;
            },
            changePageNum(pageNum){
                this.pageNum = pageNum;
            },
            changeDataPage(number){
                // 更改table里的数据
                let that = this;
                axios.get("http://mock-api.com/wz2vlNzL.mock/title?pageNum=" + number +"&pageSize=10").then(function (res) {
                    console.log(res.data);
                    console.log(that.msg);
                    that.tableData = res.data;
                })
            }
        },
        created: function(){
            let that = this;
            axios.get("http://mock-api.com/wz2vlNzL.mock/title?pageNum=" +  1 +"&pageSize=10").then(function (res) {
                console.log(res.data);
                console.log(that.msg);
                that.tableData = res.data;
            })
            axios.get("http://mock-api.com/wz2vlNzL.mock/pageNumber").then(function (res) {
                console.log(that.pageSizeNumber = res.data.data.pageSizeNumber)
                console.log(res.data.data.pageSizeNumber);
                console.log(that.pageSizeNumber)
                // 如果为首页，按钮不可用
                if(that.pageNum == 1){
                    that.pagOn = 1;
                }
                // 如果为页尾，按钮不可用
                if(that.pageSizeNumber == that.pageNum){
                    that.pagUn = 1;
                }
            })
        }
    }
</script>
